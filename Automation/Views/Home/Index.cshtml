@{
    ViewBag.Title = "Home Page";
}

<div class="jumbotron">
    <h1>SSE WININF - Monitoring and Automation Site</h1>
</div>

<div id="SCOMNewModal" class="modal fade">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">New SCOM Alerts</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                <div id="SCOMAlert" style="font-size:18px;">
                </div>
                <div class="modal-footer">
                    <button data-dismiss="modal" class="btn btn-success btn-lg">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="col-md-12">
    <h2>Welcome to the SSE WinInf Monitoring and Automation Site</h2>
    <p>
        This site has been designed to assist in monitoring of the estate, and running of standardised PowerShell scripts. The hope is this will reduce mistakes and allow code to be run efficiently.
    </p>
    <p><a class="btn btn-default" href="https://go.microsoft.com/fwlink/?LinkId=301865">Learn more &raquo;</a></p>
</div>

<div class="row">
    <div class="col-md-4">
        <h2><img src="~/Images/scom.png" style="height: 100px; margin: 5px"><span style="vertical-align: top">SCOM Monitoring </span></h2>
        <div id="SCOMPartial">
            Loading . . .
        </div>
    </div>
    <div class="col-md-4">
        <h2><img src="~/Images/PowerShell.png" style="height: 100px; margin: 5px"><span style="vertical-align: top">PowerShell Scripts</span></h2>
        <div id="PSPartial">
            Loading. . .
        </div>
    </div>
    <div class="col-md-4"
         <h2>GPOs</h2>
         <div id="GPOPartial">
            Loading. . .     
         </div>
    </div>
</div>

@section Scripts {
    <script type='text/javascript'>

        $(document).ready(function () {
            $('#SCOMPartial').load('/SCOM/GetPartial?partialName=_SCOM');
            $('#PSPartial').load('/PowerShell/GetPSPartial');
            $('#GPOPartial').load('/AD/GPOIndex');
        });

        $(function () {
            setInterval(function () {
                $('#SCOMPartial').load('/SCOM/GetPartial?partialName=_SCOM');
                $('#PSPartial').load('/PowerShell/GetPSPartial');
            }, 900000);
        });

        $(document).on('click', '#SCOMNewLink', function () {
            $('#SCOMAlert').load('/SCOM/GetPartial?partialName=_SCOMAlertNew');
        });

        $(document).on('click', '#SCOMClusterLink', function () {
            $('#SCOMAlert').load('/SCOM/GetPartial?partialName=_SCOMClusters');
        });
        $(document).ready(function () {
            $('#SCOMNewModal').on('show.bs.modal', function () {
                $(this).find('.modal-dialog').css({
                    postion: 'relative',
                    display: 'table',
                    width: '100%', //probably not needed
                    height: 'auto', //probably not needed 
                    'max-width': '100%',
                    'max-height': '100%!important'
                });
            });
            $('#SCOMNewModal').on('hidden.bs.modal', function () {
                $(this).find('#SCOMAlert').html("<div id='SCOMAlert'>Loading . . .</div>");
            });
        });

    </script>
}

