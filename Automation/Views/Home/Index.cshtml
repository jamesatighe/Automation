@{
    ViewBag.Title = "Home Page";
}

<div id="SCOMNewModal" class="modal fade">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">New SCOM Alerts</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                <div id="SCOMAlert" style="font-size:18px;">
                </div>
                <div class="modal-footer">
                    <button data-dismiss="modal" class="btn btn-success btn-lg">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row col-centered" style="margin-top: 100px;">
    <div class="btn-group" role="button" aria-label="NewWidget">
        <button type="button" id="metricCard" class="btn btn-info">Metric Card</button>
    </div>
    <div class="col-lg-12 col-md-12 col-sm-12 maxheight" style="display: table">

        <div id="SCOMPartial" style="display: table">
            Loading . . .
        </div>

        @*<div id="GPOPartial" style="display: table">
                Loading. . .
            </div>*@
    </div>
</div>
@section Scripts {
    <script type='text/javascript'>

        $(document).ready(function () {
            $('#SCOMPartial').load('/SCOM/GetPartial?partialName=_SCOM', function () {
                $(this).find('.sortable').append($('<div class="row">').load('/AD/ADServiceHealth'));
            });
        });

        $(document).on('click', '#SCOMNewLink', function () {
            $('#SCOMAlert').load('/SCOM/GetPartial?partialName=_SCOMAlertNew');
        });

        $(document).on('click', '#SCOMClusterLink', function () {
            $('#SCOMAlert').load('/SCOM/GetPartial?partialName=_SCOMClusters');
        });
        $(document).ready(function () {
            $('#SCOMNewModal').on('show.bs.modal', function () {
                $(this).find('.modal-dialog').css({
                    postion: 'relative',
                    display: 'table',
                    width: 'auto', //probably not needed
                    height: 'auto', //probably not needed
                    'max-width': '100%',
                    'max-height': '100%!important'
                });
            });
            $('#SCOMNewModal').on('hidden.bs.modal', function () {
                $(this).find('#SCOMAlert').html("<div id='SCOMAlert'>Loading . . .</div>");
            });
        });

        $(document).on('click', '#metricCard', function () {
            var column = $('#SCOMPartial').find('.cardpanel').length + 1
            $('#SCOMPartial').find('.sortable').append($('<div class="cardpanel panel-inverse clearfix resizable-card ui-sortable" id= "column_' + column + '">').load('/SCOM/CreateMetricCard?total=99&Title="Test%20Widget"&Label=Total'));
            $('#column_' + column).resizable({
                ghost: true,
                minWidth: 200,
                minHeight: 255,
                grid: [40, 40],
                animate: true,
                stop: function (event, ui) {
                    id = ui.element.attr('id')
                    var uiheight = $('#' + id).height();
                    var uiwidth = $('#' + id).width();
                    $.cookie(id + 'height', uiheight);
                    $.cookie(id + 'width', uiwidth);
                    $.cookie(id + 'font-p', $('#' + id + ' div p').css("font-size"));
                    $.cookie(id + 'font-h2', $('#' + id + ' div h2').css("font-size"));
                    $('.resizable-card p').fitText(0.4, { maxFontSize: '80px' });
                    $('.resizable-card h2').fitText(0.6, { maxFontSize: '70px' });
                }

            });
            
        });
    </script>
}

